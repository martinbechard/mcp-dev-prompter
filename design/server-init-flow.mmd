<!--
Copyright (c) 2024 Martin Bechard <martin.bechard@DevConsult.ca>
This software is licensed under the MIT License.
File: /Users/martinbechard/dev/mcp-dev-prompter/design/server-init-flow.mmd
This was generated by Claude Sonnet 3.5, with the assistance of my human mentor

Flow diagram for server initialization
Flowcharts: Making template loading a beautiful dance!
-->

sequenceDiagram
    participant Main as stdio-server
    participant Transport as StdioServerTransport
    participant Server as DevPrompterServer
    participant Loader as TemplateLoader
    participant Generator as PromptGenerator
    participant Logger as Logger
    participant FS as FileSystem

    Main->>Logger: Initialize
    Main->>Server: Create
    
    Server->>Loader: Create
    Server->>Generator: Create(loader)
    
    Server->>Server: Setup MCP Handlers
    
    Server->>Loader: Load Templates
    Loader->>FS: Read Template Directory
    FS-->>Loader: Template Files
    
    loop For Each Template
        Loader->>FS: Read Template File
        FS-->>Loader: Template Content
        Loader->>Loader: Parse & Validate
        Loader->>Loader: Cache Template
        Loader->>Logger: Log Template Loaded
    end
    
    Main->>Transport: Create Transport
    Main->>Server: Connect(transport)
    Server->>Main: Ready
    Main->>Logger: Log Server Ready