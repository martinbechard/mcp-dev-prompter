<!--
Copyright (c) 2024 Martin Bechard <martin.bechard@DevConsult.ca>
This software is licensed under the MIT License.
File: /Users/martinbechard/dev/mcp-dev-prompter/design/Constants.md
This was generated by Claude Sonnet 3.5, with the assistance of my human mentor

Design document for Constants definitions used throughout the Dev Prompter server
Where templates and configuration meet to make magic happen!
-->

# Table of Contents
- Const: TEMPLATE_CONSTANTS
- Const: SYSTEM_CONSTANTS

---
# Const: TEMPLATE_CONSTANTS

## Overview
Frozen object containing all template-related constants including paths, validations, and format specifications

## Design Requirements
1. MUST be implemented as a frozen object to prevent modification
   Source: TypeScript best practices for configuration constants
2. MUST include all required template configuration values
   Source: DevPrompterServer design
3. MUST define proper types for all values
   Source: TypeScript type safety requirements

## Design Considerations
1. Environment Variable Integration
   - WHY: Allows configuration through environment while providing defaults
   - HOW: Use process.env with fallbacks for each value
   - EXAMPLE:
     ```typescript
     TEMPLATE_DIR: process.env.TEMPLATE_DIR ?? "./templates"
     ```

2. Type Definition
   - WHY: Ensures type safety when using constants
   - HOW: Define specific types for each constant category
   - EXAMPLE:
     ```typescript
     export interface TemplateConstants {
       readonly TEMPLATE_DIR: string;
       readonly FILE_EXTENSION: string;
       // etc
     }
     ```

## Attributes
```typescript
interface TemplateConstants {
    /** Directory containing template files */
    readonly TEMPLATE_DIR: string;

    /** Required file extension for templates */
    readonly FILE_EXTENSION: string;

    /** Maximum template file size in bytes */
    readonly MAX_FILE_SIZE: number;

    /** Required template sections */
    readonly REQUIRED_SECTIONS: readonly string[];

    /** Handlebars options */
    readonly HANDLEBARS_OPTIONS: Readonly<{
        strict: boolean;
        noEscape: boolean;
    }>;

    /** Template cache settings */
    readonly CACHE_OPTIONS: Readonly<{
        enabled: boolean;
        maxAge: number;
    }>;
}

const TEMPLATE_CONSTANTS: TemplateConstants = Object.freeze({
    TEMPLATE_DIR: process.env.TEMPLATE_DIR ?? "./templates",
    FILE_EXTENSION: ".md",
    MAX_FILE_SIZE: 1024 * 1024, // 1MB
    REQUIRED_SECTIONS: ["title", "description", "template"],
    HANDLEBARS_OPTIONS: {
        strict: true,
        noEscape: true
    },
    CACHE_OPTIONS: {
        enabled: true,
        maxAge: 5 * 60 * 1000 // 5 minutes
    }
});
```

# Const: SYSTEM_CONSTANTS

## Overview
Frozen object containing general system constants including server configuration and timeouts

## Design Requirements
1. MUST be implemented as a frozen object
2. MUST include all system-level configuration
3. MUST support environment variable overrides

## Attributes
```typescript
interface SystemConstants {
    /** Server identification */
    readonly SERVER: Readonly<{
        name: string;
        version: string;
    }>;

    /** Logging configuration */
    readonly LOGGING: Readonly<{
        enabled: boolean;
        level: string;
        maxEntries: number;
    }>;

    /** Operation timeouts */
    readonly TIMEOUTS: Readonly<{
        templateLoad: number;
        promptGeneration: number;
    }>;

    /** Error handling */
    readonly ERROR: Readonly<{
        maxRetries: number;
        retryDelay: number;
    }>;
}

const SYSTEM_CONSTANTS: SystemConstants = Object.freeze({
    SERVER: {
        name: "dev-prompter-mcp-server",
        version: process.env.npm_package_version ?? "1.0.0"
    },
    LOGGING: {
        enabled: process.env.LOGGING_ENABLED !== "false",
        level: process.env.LOG_LEVEL ?? "info",
        maxEntries: parseInt(process.env.MAX_LOG_ENTRIES ?? "1000", 10)
    },
    TIMEOUTS: {
        templateLoad: 5000,    // 5 seconds
        promptGeneration: 10000 // 10 seconds
    },
    ERROR: {
        maxRetries: 3,
        retryDelay: 1000
    }
});
```