<!--
Copyright (c) 2024 Martin Bechard <martin.bechard@DevConsult.ca>
This software is licensed under the MIT License.
File: /Users/martinbechard/dev/mcp-dev-prompter/design/Logger.md
This was generated by Claude Sonnet 3.5, with the assistance of my human mentor

Design document for the Logger utility class and its associated types
Because printf debugging is so last century! 📝
-->

# Table of Contents

- Type: LogMessages
- Class: Logger

---

# Type: LogMessages

## Overview

Enum type defining all log message templates used throughout the application

## Design Requirements

1. MUST be implemented as a TypeScript enum for compile-time checks
2. MUST include messages for all major server operations and error conditions
3. MUST follow consistent message format with timestamps
4. MUST be colocated with Logger class

## Attributes

```typescript
enum LogMessages {
  SERVER_START = "Dev Prompter MCP Server starting",
  SERVER_READY = "Server ready and listening",
  TEMPLATE_DIR_INIT = "Initializing template directory",
  TEMPLATE_SCAN = "Scanning for template files",
  TEMPLATE_LOAD = "Loading template",
  TEMPLATE_LOADED = "Template loaded successfully",
  TEMPLATE_ERROR = "Error loading template",
  TEMPLATE_PARSE = "Parsing template content",
  TEMPLATE_PARSE_COMPLETE = "Template parsing complete",
  PROMPT_REQUEST = "Prompt generation requested",
  PROMPT_ARGS_DEBUG = "Prompt arguments received",
  PROMPT_TEMPLATE_DEBUG = "Using template content",
  PROMPT_GENERATED = "Prompt generated successfully",
  VALIDATION_ERROR = "Validation error",
  VALIDATION_DETAILS = "Validation details",
  VALIDATION_COMPLETE = "Validation complete",
  CONFIG_ERROR = "Configuration error",
  HANDLER_SETUP = "Setting up request handlers",
  HANDLER_REGISTERED = "Handler registered",
  RESPONSE_FORMATTED = "Response formatting complete",
}
```

---

# Class: Logger

## Overview

Static utility class that handles all logging operations throughout the application

## Design Requirements

1. MUST be implemented as a static utility class
2. MUST write all logs to ~/Library/Logs/Claude/mcp-dev-prompter.log
3. MUST maintain in-memory logs for resource handler access
4. MUST initialize logger with debug flag
5. MUST provide debug state inspection via isDebugEnabled()
6. MUST provide initialization state via isInitialized()
7. MUST auto-initialize on first log if not initialized
8. MUST use stderr for all console output to avoid interfering with protocol messages
9. MUST include timestamps with all log entries
10. MUST handle asynchronous file operations
11. MUST NEVER write to stdout as it's reserved for protocol messages

## Functions

1. initialize(debug: boolean): Promise<void>

   ```typescript
   - Set debug mode
   - Create log directory if needed
   - Write initialization message to stderr
   - Set initialized flag
   ```

2. trace(message: string, data?: any): Promise<void>

   ```typescript
   - Auto-initialize if needed
   - Get timestamp
   - Format log entry
   - Add debug data if enabled
   - Store in memory
   - Write to file
   - Output to stderr (not stdout)
   ```

3. error(message: string, error?: any): Promise<void>

   ```typescript
   - Auto-initialize if needed
   - Get timestamp
   - Format error entry
   - Add error details if provided
   - Store in memory
   - Write to file
   - Output to stderr
   ```

4. getLogContent(): string[]

   - Returns current log entries

5. clearLogs(): void
   - Clears in-memory logs

## Attributes

```typescript
class Logger {
  private static readonly LOG_PATH: string;
  private static logs: string[] = [];
  private static debugEnabled: boolean = false;
  private static initialized: boolean = false;
}
```
